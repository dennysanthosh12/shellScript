public List<NodeWrapper> getNodeDetails() {

    return statusrepo.findAll()
            .stream()
            .map(status -> {

                IntegrationNodeWrapper wrapper = null;

                try {

                    String json = status.getServerDetails();

                    if (json != null && !json.isBlank()) {
                        wrapper = objectMapper.readValue(
                                json,
                                IntegrationNodeWrapper.class
                        );
                    }

                } catch (Exception e) {
                    // log + ignore OR handle
                    System.out.println(
                        "JSON parse failed for IP: "
                        + status.getServerIp()
                    );
                }

                return new NodeWrapper(
                        status.getServerIp(),
                        status.getStatus(),
                        status.getLastChecked(),
                        wrapper   // can be null safely
                );
            })
            .toList();
}
