private Mono<Void> callAceApi(NodeEndpoint ep) {

    String url = String.format(
            "%s://%s:%d/apiv2",
            ep.getProtocol(), ep.getHost(), ep.getPort());

    return webClient.get()
            .uri(url)
            .retrieve()
            .bodyToMono(IntegrationNodeWrapper.class)
            .flatMap(resp ->
                Mono.fromRunnable(() -> saveStatus(ep, resp))
                    .subscribeOn(Schedulers.boundedElastic())
            )
            .onErrorResume(ex -> {
                saveDownStatus(ep, ex);
                return Mono.empty();
            })
            .then();
}
private void saveDownStatus(NodeEndpoint ep, Throwable ex) {

    IntegrationStatus status =
            new IntegrationStatus(
                    ep.getName(),
                    ep.getHost(),
                    "DOWN",
                    LocalDateTime.now(),
                    null);

    statusRepository.save(status);
}private void saveDownStatus(NodeEndpoint ep, Throwable ex) {

    IntegrationStatus status =
            new IntegrationStatus(
                    ep.getName(),
                    ep.getHost(),
                    "DOWN",
                    LocalDateTime.now(),
                    null);

    statusRepository.save(status);
}

return Flux.fromIterable(endpoints)
        .flatMap(this::callAceApi) // async by default
        .then();


